# M3 – 지급 정보 & PDF 서류 5종  
> 지급 정보 입력 · PDF 인프라 · 템플릿 · PDF 생성

---

## M3-WP1. 지급 정보 입력 플로우

**사용자 가치**  
보호자가 실제 지급한 간병비 정보를 정리해서 남길 수 있다.

**Scope**  
- 케이스 상세에 [지급 정보 입력] 버튼
- `/cases/[id]/payment` 또는 모달
  - 총 일수(자동 계산 + 수정 가능)
  - 총액, 지급일, 지급 방식 입력
- `savePayment` 서버 액션
  - `payments` 테이블에 생성/수정
- 케이스 상세 상단 요약에 지급 정보 간단 표시

**완료 기준**  
- 지급 정보 입력·수정 시 화면과 DB 모두 반영
- 지급 정보가 없는 경우 “미입력” 표시

---

## M3-WP2. PDF 인프라 & 한글 폰트 PoC

**사용자 가치**  
한글이 깨지지 않는 PDF를 생성할 수 있는 기반을 확보한다.

**Scope**  
- 프로젝트에 한글 폰트 파일 추가(ex. Nanum 계열)
- React-PDF 설정으로 폰트 등록
- 테스트용 액션:
  - 간단한 한글 텍스트 PDF 생성
- 로컬 + Vercel 배포 환경에서 테스트:
  - 브라우저에서 PDF 열어 한글 정상 출력 여부 확인

**완료 기준**  
- 한글이 포함된 PDF가 로컬/프로덕션 둘 다에서 깨지지 않고 보임
- 폰트 경로 및 배포 관련 문제 해결

---

## M3-WP3. PDF 템플릿 – 5종 서류 구성

**사용자 가치**  
보험 청구에 필요한 형식의 서류를 한 번에 만들 수 있다.

**Scope**  
- React-PDF 템플릿 구성 (1개의 PDF 내 5섹션 또는 5페이지)
  1. 간병 계약서  
     - 보호자·간병인·환자 정보, 기간, 일당, 주요 조항
  2. 간병일지 요약  
     - 날짜별 체크 결과, 메모를 표 형식으로 요약
  3. 간병인 확인서  
     - 간병인이 해당 기간 동안 간병했음을 확인하는 문구
  4. 소속 확인서  
     - 사업자 정보, 직업소개업 등록번호, 간병인 소속 확인 문구
  5. 간병비 지급 확인서  
     - 지급일, 총액, 지급 방식, 수령 확인 문구
- 하단 고정 문구 추가  
  - “이 서류는 보험 청구용이며, 연말정산 의료비 공제용 영수증이 아닙니다.”

**완료 기준**  
- 샘플 케이스로 PDF 생성 시 위 5개 서류 구성이 모두 포함된 문서 출력

---

## M3-WP4. PDF 생성 버튼 + 조건 체크

**사용자 가치**  
보호자가 모든 준비를 마친 뒤, 클릭 한 번으로 제출 가능한 서류를 받을 수 있다.

**Scope**  
- 케이스 상세에 [PDF 서류 만들기] 버튼
- `generatePdf(caseId)` 서버 액션
  - `cases`, `care_logs (is_active=true)`, `payments` 조회
  - 보호자 동의, 간병인 동의, 최소 일지, 지급 정보 유무 체크
  - 조건 미충족 시 부족 항목 리스트 안내
  - 조건 충족 시 PDF 생성 및 다운로드 응답
- UI
  - 생성 중 로딩 표시
  - 성공 시 다운로드 안내

**완료 기준**  
- 정상 플로우 케이스에서 PDF 버튼 클릭 시 실제 PDF 파일 다운로드
- 조건 미충족 시 어떤 항목이 부족한지 명확히 안내
