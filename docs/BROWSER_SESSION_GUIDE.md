# 🔐 브라우저 세션 및 테스트 가이드

## 📌 중요: 같은 브라우저에서 로그인 상태 공유

### 정상 동작입니다! ✅

한 브라우저에서 로그인하면, 같은 브라우저의 **모든 탭/창**에서 로그인 상태가 유지됩니다.

**이유**: 브라우저는 **쿠키(Cookie)**를 사용해 로그인 상태를 저장하고, 쿠키는 브라우저 레벨에서 공유됩니다.

---

## 🧪 여러 계정으로 테스트하는 방법

### ❌ 잘못된 방법
```
일반 창에서 계정 A 로그인
→ 새 탭 열기
→ 계정 B로 로그인 시도
→ 계정 A 세션이 유지됨 (쿠키 공유)
```

### ✅ 올바른 방법 1: 시크릿 모드 사용
```
일반 창: 계정 A 로그인
시크릿 창(Ctrl+Shift+N): 계정 B 로그인
→ 2개 계정 동시 사용 가능! ✅
```

### ✅ 올바른 방법 2: 다른 브라우저 사용
```
Chrome: 계정 A 로그인
Firefox: 계정 B 로그인
→ 2개 계정 동시 사용 가능! ✅
```

### ✅ 올바른 방법 3: 로그아웃 후 재로그인
```
1. 계정 A 로그아웃
2. 계정 B 로그인
→ 1개 계정만 사용 ✅
```

---

## 🔍 보안 테스트 시나리오

### 목표: 계정 A가 계정 B의 데이터를 볼 수 없는지 확인

#### Step 1: 계정 2개 준비
```
계정 A: testuser1 / password1234
계정 B: testuser2 / password1234
```

#### Step 2: 각 계정으로 케이스 생성
**일반 창 (계정 A)**:
```
1. /login 접속
2. 계정 A 로그인
3. 케이스 1개 생성
4. URL 확인: http://localhost:3000/cases/[A의ID]
```

**시크릿 창 (계정 B)**:
```
1. Ctrl + Shift + N (시크릿 모드)
2. http://localhost:3000/login 접속
3. 계정 B 로그인
4. 케이스 1개 생성
```

#### Step 3: 보안 확인 (⭐ 중요!)
**시크릿 창 (계정 B 상태)**:
```
1. /cases 접속
   → 계정 B의 케이스 1개만 표시 ✅
   → 계정 A의 케이스는 보이면 안 됨! ❌

2. 계정 A의 URL 직접 입력:
   http://localhost:3000/cases/[A의ID]
   → "권한이 없습니다" 메시지 표시 ✅
   → 케이스 정보 보이면 안 됨! ❌
```

---

## 💡 자주 묻는 질문 (FAQ)

### Q1: 로그아웃하지 않고 다른 계정으로 바꿀 수 있나요?
**A**: 아니요. 로그아웃 후 다시 로그인하거나, 시크릿 모드를 사용해야 합니다.

### Q2: 회원가입 후 자동으로 로그인되나요?
**A**: 아니요. 회원가입 후 **로그인 페이지로 이동**하며, 직접 로그인해야 합니다.

### Q3: 같은 브라우저에서 여러 계정을 동시에 사용할 수 있나요?
**A**: 시크릿 모드를 사용하면 가능합니다.
- 일반 창: 계정 A
- 시크릿 창: 계정 B

### Q4: 왜 새 탭을 열어도 로그인 상태가 유지되나요?
**A**: 브라우저가 쿠키를 공유하기 때문입니다. 이는 정상 동작입니다.

### Q5: 로그아웃 버튼이 안 보여요
**A**: `/cases` 페이지 우측 상단에 있습니다. 스크롤을 위로 올려보세요.

---

## 🧪 M2 보안 테스트 체크리스트

테스트 전 반드시 읽으세요!

### 준비
- [ ] Chrome 일반 창 + 시크릿 창 준비
- [ ] 2개 계정 준비 (testuser1, testuser2)

### 테스트
- [ ] 계정 A: 케이스 생성
- [ ] 계정 B: /cases에서 계정 A 케이스 안 보임
- [ ] 계정 B: 계정 A URL 직접 접근 → 차단됨
- [ ] 계정 A: /cases에서 계정 B 케이스 안 보임

### 결과
- [ ] 모든 테스트 통과 → M2 완료 ✅

---

## 🚨 주의사항

### 1. 시크릿 모드 창을 닫으면
- 시크릿 모드의 모든 로그인 정보가 **즉시 삭제**됩니다.
- 다시 시크릿 창을 열면 **새로운 세션**으로 시작됩니다.

### 2. 개발자 도구(F12)로 쿠키 확인
```
개발자 도구 → Application → Cookies
→ sb-[프로젝트ID]-auth-token 확인
```

### 3. 강제 로그아웃 방법
```
방법 1: 로그아웃 버튼 클릭
방법 2: 브라우저 쿠키 삭제 (F12 → Application → Cookies)
방법 3: 시크릿 모드 창 닫기
```

---

## 📚 관련 문서

- [M2 테스트 시나리오](./M2_TEST_SCENARIOS.md)
- [M2 완료 보고서](./M2_COMPLETE_REPORT.md)

---

**작성일**: 2025-12-07  
**버전**: 1.0

